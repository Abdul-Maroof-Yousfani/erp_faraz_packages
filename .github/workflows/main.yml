- name: Execute SSH commands
        uses: appleboy/ssh-action@master
        with:
          host: ${{ secrets.SFTP_HOST }}
          username: ${{ secrets.SFTP_USER }}
          password: ${{ secrets.SFTP_PASS }}
          script: |
            cd /var/www/farazpack
            
            # Directory structure setup
            mkdir -p storage/framework/{sessions,views,cache}
            mkdir -p bootstrap/cache
            
            # Permissions fix
            chmod -R 775 storage bootstrap/cache
            
            # 1. Composer Install (Try 'composer' directly first, if it fails, use full path)
            # Agar 'composer' command nahi milti toh 'which composer' se path check karein
            composer install --no-dev --optimize-autoloader --no-interaction || php7.4 /usr/local/bin/composer install --no-dev --optimize-autoloader --no-interaction

            # 2. Laravel Optimization (Fixed syntax: removed extra 'php')
            if [ -f .env ]; then
                php7.4 artisan config:cache
                php7.4 artisan route:cache
                php7.4 artisan view:cache
                # php7.4 artisan migrate --force
            else
                echo ".env file not found, skipping artisan commands"
            fi
